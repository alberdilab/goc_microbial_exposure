[["index.html", "AlberdiLab | XXX et al. in prep Gut on a chip microbial exposure Chapter 1 Introduction 1.1 Prepare the R environment", " AlberdiLab | XXX et al. in prep Gut on a chip microbial exposure Ostaizka Aizpurua1 Antton Alberdi2 2024-06-24 Chapter 1 Introduction This webbook contains all the code used for data analysis in study on the recovery of metagenome‑assembled genomes and derived microbial communities from lizard fecal and cloacal samples. 1.1 Prepare the R environment 1.1.1 Environment To reproduce all the analyses locally, clone this repository in your computer using: RStudio &gt; New Project &gt; Version Control &gt; Git And indicating the following git repository: https://github.com/alberdilab/goc_microbial_exposure.git Once the R project has been created, follow the instructions and code chunks shown in this webbook. 1.1.2 Libraries The following R packages are required for the data analysis. # Base library(R.utils) library(knitr) library(tidyverse) library(devtools) library(tinytable) library(broom) library(broom.mixed) library(phyloseq) library(edgeR) library(DESeq2) library(ggplot2) library(gplots) library(tidyverse) library(fgsea) University of Copenhagen, ostaizka.aizpurua@sund.ku.dk↩︎ University of Copenhagen, antton.alberdi@sund.ku.dk↩︎ "],["data-overview.html", "Chapter 2 Data overview", " Chapter 2 Data overview #Load only data from the last experiment counts &lt;- read_tsv(&quot;data/gene_counts.tsv&quot;) %&gt;% column_to_rownames(.,&quot;gene_id&quot; ) metadata &lt;- read_tsv(&quot;data/sample_metadata.tsv&quot;) "],["deseq2.html", "Chapter 3 Deseq2 3.1 CON vs EFC 3.2 CON vs PAC 3.3 CON vs PAM 3.4 PAM vs PAC", " Chapter 3 Deseq2 #phyloseq object without structural zeros phylo_samples &lt;- metadata %&gt;% column_to_rownames(&quot;sample&quot;) %&gt;% sample_data() #convert to phyloseq sample_data object phylo_counts &lt;- counts %&gt;% otu_table(., taxa_are_rows = TRUE) #convert to phyloseq otu_table object physeq &lt;- phyloseq(phylo_counts, phylo_samples) 3.1 CON vs EFC baseMean log2FoldChange lfcSE stat pvalue padj LOC100288175 3.202773e+02 0.4289417 0.19891823 2.156372 0.0310546155 0.9999693 FAAP20 7.186203e+02 0.3376469 0.15526617 2.174633 0.0296576227 0.9999693 NPHP4 4.109280e+02 0.3800246 0.17545400 2.165950 0.0303150239 0.9999693 TNFRSF25 5.117722e+02 0.3231542 0.16409292 1.969337 0.0489144602 0.9999693 SRM 1.164465e+03 0.2654865 0.11930274 2.225318 0.0260598922 0.9999693 HSPG2 1.337487e+04 0.1999676 0.08798164 2.272834 0.0230362046 0.9999693 RPL11 2.162607e+04 0.2193211 0.07021483 3.123573 0.0017866947 0.9999693 RSRP1 1.196369e+03 0.2502307 0.11649395 2.148014 0.0317126197 0.9999693 BMP8A 3.909115e+02 -0.5251121 0.17363407 -3.024246 0.0024925375 0.9999693 LINC01762 3.140743e+00 -5.3255548 2.32603848 -2.289539 0.0220480807 0.9999693 S100A6 2.519940e+02 0.5569888 0.23215465 2.399215 0.0164302770 0.9999693 EFNA1 4.407369e+03 0.2357270 0.09690328 2.432601 0.0149908089 0.9999693 MEX3A 4.178312e+02 0.4342035 0.19356279 2.243218 0.0248827759 0.9999693 NES 1.748551e+03 0.2740077 0.09796731 2.796930 0.0051590737 0.9999693 DDR2 4.588083e+01 -1.2379584 0.49351248 -2.508464 0.0121257250 0.9999693 KIAA0040 4.187737e+02 -0.4051275 0.17545281 -2.309040 0.0209413828 0.9999693 MIR205HG 2.603270e+00 -5.0382625 2.42656287 -2.076296 0.0378665917 0.9999693 PROX1 4.153563e+02 0.3929270 0.18843019 2.085266 0.0370451833 0.9999693 CENPF 2.093157e+03 0.2387922 0.11336867 2.106333 0.0351754333 0.9999693 MIR215 2.650314e+00 -5.0787258 2.43915546 -2.082166 0.0373273399 0.9999693 OBSCN 6.840197e+02 0.2968349 0.13850527 2.143131 0.0321026121 0.9999693 FH 2.334280e+03 0.1790654 0.08852786 2.022701 0.0431040260 0.9999693 TMEM18-DT 2.837346e+00 4.7283991 2.36502730 1.999300 0.0455759019 0.9999693 CENPO 3.666587e+02 0.3570075 0.18159142 1.965993 0.0492994168 0.9999693 OST4 1.532739e+03 0.2851922 0.10330576 2.760661 0.0057684555 0.9999693 LOC124907749 3.729673e+00 5.1223574 2.20214366 2.326078 0.0200144023 0.9999693 LOC107985767 5.162275e+00 -3.4252534 1.70440164 -2.009652 0.0444680793 0.9999693 FBXO48 9.621204e+01 -0.7741430 0.33278146 -2.326280 0.0200035937 0.9999693 GFPT1 1.057943e+04 -0.1445112 0.07026152 -2.056762 0.0397091339 0.9999693 RNF103 2.067888e+03 -0.2122581 0.09373767 -2.264385 0.0235504645 0.9999693 MZT2A 2.563798e+03 0.2215716 0.10913588 2.030236 0.0423325947 0.9999693 LINC01876 1.438105e+02 0.6490629 0.28377456 2.287248 0.0221813246 0.9999693 GORASP2 4.340152e+03 -0.1653775 0.07996452 -2.068136 0.0386272083 0.9999693 CDCA7 5.376429e+02 0.3770838 0.15996583 2.357277 0.0184095096 0.9999693 HSPE1 6.133859e+02 0.3072456 0.14722640 2.086892 0.0368978731 0.9999693 CCNYL1 2.292778e+03 -0.2064265 0.09804094 -2.105513 0.0352466860 0.9999693 FN1 9.821128e+04 0.1799756 0.06313796 2.850513 0.0043648777 0.9999693 IHH 3.346147e+03 0.1950184 0.08679138 2.246979 0.0246413396 0.9999693 MIR3131 8.152157e+01 0.7847475 0.36888591 2.127345 0.0333914546 0.9999693 PTMA 1.322023e+04 0.1681442 0.08458420 1.987892 0.0468236848 0.9999693 MAB21L4 1.428760e+03 0.2346224 0.11903857 1.970978 0.0487263747 0.9999693 FBLN2 4.947770e+02 0.4214783 0.19140835 2.201985 0.0276663808 0.9999693 RAD54L2 8.583555e+02 0.2562448 0.12418858 2.063352 0.0390791588 0.9999693 RPL24 2.915664e+03 0.2354707 0.08717255 2.701202 0.0069089384 0.9999693 SPICE1 1.229055e+01 2.0918028 0.98894143 2.115194 0.0344134310 0.9999693 HEG1 6.827524e+02 -0.2758572 0.13580873 -2.031218 0.0422328654 0.9999693 PODXL2 1.762626e+03 0.2931479 0.11707064 2.504026 0.0122789138 0.9999693 TF 1.349946e+03 -0.3333808 0.13987271 -2.383458 0.0171508194 0.9999693 CEP70 4.714780e+02 0.4887052 0.18257530 2.676732 0.0074344036 0.9999693 PIK3CB 1.834867e+03 -0.2142938 0.09602088 -2.231742 0.0256320178 0.9999693 YEATS2-AS1 1.357266e+01 2.7086403 1.02341618 2.646666 0.0081289713 0.9999693 APOD 5.160515e+03 -0.2145430 0.08407977 -2.551660 0.0107211128 0.9999693 ATP5ME 2.563185e+03 0.2191379 0.10068721 2.176422 0.0295237020 0.9999693 MYL5 4.760047e+02 0.3225582 0.16185415 1.992894 0.0462730114 0.9999693 NSD2 2.249678e+03 0.2188541 0.08991398 2.434039 0.0149313972 0.9999693 KLHL5 1.230838e+03 0.2314178 0.11782865 1.964020 0.0495277892 0.9999693 RPL9 1.558365e+04 0.1983267 0.07899346 2.510673 0.0120501332 0.9999693 PDGFRA 2.601172e+02 0.4812382 0.21935002 2.193928 0.0282405655 0.9999693 AFP 4.214866e+05 -0.1847444 0.08542503 -2.162649 0.0305681681 0.9999693 HERC3 5.824401e+02 -0.3149127 0.14714958 -2.140086 0.0323478484 0.9999693 LOC112267901 2.895528e+00 -5.2074396 2.37809056 -2.189757 0.0285418902 0.9999693 RPL34 9.974779e+03 0.1972869 0.07880503 2.503481 0.0122978299 0.9999693 MAD2L1 8.208985e+02 0.3565426 0.13859802 2.572494 0.0100968709 0.9999693 TRIM2 9.800311e+02 0.2735418 0.12595046 2.171821 0.0298691853 0.9999693 MSMO1 8.661669e+03 -0.2004464 0.08024775 -2.497844 0.0124951016 0.9999693 HMGB2 2.868280e+03 0.2037337 0.09867488 2.064696 0.0389517363 0.9999693 NDUFS6 1.325768e+03 0.2247564 0.10597665 2.120811 0.0339377436 0.9999693 AMACR 1.997980e+02 0.6691968 0.24465128 2.735309 0.0062321749 0.9999693 PARP8 3.890036e+00 5.1848448 2.14049494 2.422264 0.0154241206 0.9999693 RPS23 2.590374e+04 0.1593903 0.08100732 1.967603 0.0491137152 0.9999693 ARRDC3 1.881676e+03 0.2387985 0.11830631 2.018477 0.0435416561 0.9999693 LOC105379082 5.095304e+00 3.9933410 1.92215573 2.077532 0.0377524402 0.9999693 PAM 3.406521e+03 -0.2381536 0.08170220 -2.914898 0.0035580428 0.9999693 CHSY3 2.958936e+01 1.2026002 0.60754246 1.979451 0.0477653053 0.9999693 TCOF1 3.370177e+03 0.2111180 0.08165194 2.585585 0.0097213903 0.9999693 HAVCR1 5.780421e+03 -0.1795975 0.07848047 -2.288436 0.0221121610 0.9999693 CYFIP2 3.100804e+02 -0.4112387 0.19587015 -2.099548 0.0357686571 0.9999693 FABP6 2.475204e+02 0.4759251 0.22081886 2.155274 0.0311404210 0.9999693 HNRNPAB 3.759727e+03 0.1666617 0.08063657 2.066825 0.0387506151 0.9999693 HMGA1 4.998568e+03 0.3244230 0.08586903 3.778114 0.0001580206 0.9999693 LOC105375035 2.999611e+00 -5.2233464 2.43081363 -2.148806 0.0316497998 0.9999693 KIF6 2.934990e+00 4.7820465 2.38691222 2.003445 0.0451295849 0.9999693 SLC29A1 1.647902e+03 0.2473028 0.10577332 2.338045 0.0193849080 0.9999693 MCM3 1.927577e+03 0.2410457 0.10320502 2.335601 0.0195120596 0.9999693 LMBRD1 2.714495e+03 -0.1764673 0.08915921 -1.979239 0.0477891532 0.9999693 LIN28B 2.889483e+02 0.4190965 0.20738406 2.020871 0.0432930781 0.9999693 CCN2-AS1 6.292678e+00 4.3263878 1.84480089 2.345179 0.0190179601 0.9999693 LOC116435278 2.790307e+00 4.7063505 2.35816834 1.995765 0.0459594795 0.9999693 SLC29A4 1.946539e+03 0.1920903 0.09748106 1.970540 0.0487765540 0.9999693 TSPAN13 7.218594e+03 -0.1438712 0.07318050 -1.965977 0.0493012560 0.9999693 LIMK1 7.983982e+02 0.2958883 0.13124299 2.254508 0.0241642558 0.9999693 PCLO 1.490808e+02 0.6021544 0.27386668 2.198714 0.0278982966 0.9999693 ATP5MF 7.733623e+02 0.3875936 0.13648498 2.839826 0.0045138118 0.9999693 MUC17 4.495827e+03 -0.1870956 0.08080639 -2.315356 0.0205934582 0.9999693 VGF 2.299567e+02 0.5154941 0.24385219 2.113961 0.0345185733 0.9999693 AKR1B1 5.049780e+02 0.3768866 0.16941467 2.224640 0.0261054436 0.9999693 EPHB6 2.316655e+01 1.5062346 0.69691047 2.161303 0.0306719479 0.9999693 ZNF767P 3.319659e+02 0.3716737 0.18756480 1.981575 0.0475268119 0.9999693 ATP6V0E2 5.528457e+02 0.3244398 0.15888896 2.041928 0.0411586914 0.9999693 MTMR7 7.126769e+00 -2.8363929 1.42856125 -1.985489 0.0470900718 0.9999693 UNC5D 2.556226e+00 -4.9967903 2.48601330 -2.009961 0.0444352930 0.9999693 MCM4 2.277195e+03 0.2008608 0.09099153 2.207467 0.0272814750 0.9999693 SNHG6 1.502820e+03 0.2931884 0.11211421 2.615087 0.0089204783 0.9999693 RPL7 2.460193e+04 0.1488441 0.07568424 1.966645 0.0492240962 0.9999693 LOC124906712 6.922783e+00 2.9489035 1.46723824 2.009833 0.0444488883 0.9999693 COX6C 2.803709e+03 0.2113238 0.09377980 2.253404 0.0242336988 0.9999693 NDRG1 1.463107e+04 -0.1391852 0.06844857 -2.033428 0.0420092994 0.9999693 CYC1 3.288617e+03 0.2173409 0.09456871 2.298233 0.0215485410 0.9999693 RECQL4 1.292240e+03 0.3250023 0.11296739 2.876957 0.0040153093 0.9999693 CCL27 5.944962e+00 -3.6613123 1.63685401 -2.236798 0.0252995237 0.9999693 WNK2 6.964500e+02 0.2854708 0.13591854 2.100308 0.0357017542 0.9999693 PTCSC2 1.879273e+02 -0.5254030 0.24583625 -2.137207 0.0325811469 0.9999693 STOM 2.782957e+03 -0.2182314 0.08538550 -2.555837 0.0105932704 0.9999693 NR6A1 5.245622e+02 0.3682878 0.16262231 2.264682 0.0235322194 0.9999693 SLC2A8 1.687301e+03 0.1947223 0.09753369 1.996462 0.0458836079 0.9999693 FPGS 6.795046e+02 0.3124889 0.14502745 2.154688 0.0311862519 0.9999693 NUP188 1.324504e+03 0.2375590 0.10962562 2.167002 0.0302346646 0.9999693 NOTCH1 2.814497e+02 0.4643470 0.20581282 2.256161 0.0240605197 0.9999693 PAXX 5.897536e+02 0.3800866 0.14804101 2.567441 0.0102452124 0.9999693 NSMF 4.729295e+03 0.1727262 0.08491437 2.034122 0.0419393112 0.9999693 LINC03029 4.351880e+00 5.3458664 2.08786645 2.560445 0.0104538332 0.9999693 P4HA1 1.124892e+04 -0.2114401 0.07701525 -2.745432 0.0060431231 0.9999693 DLG5 3.839335e+03 0.1805938 0.07823397 2.308380 0.0209779878 0.9999693 LDB3 8.690421e+00 2.6085721 1.27371668 2.048000 0.0405599766 0.9999693 GLUD1 1.761231e+04 0.1277257 0.06445135 1.981739 0.0475084832 0.9999693 LIPA 5.215286e+03 -0.2092959 0.07851741 -2.665599 0.0076851336 0.9999693 MARVELD1 1.283824e+03 0.2382015 0.10942169 2.176912 0.0294870967 0.9999693 SFRP5 7.053424e+01 0.8524521 0.40901930 2.084137 0.0371477332 0.9999693 CYP17A1-AS1 2.405100e+00 -4.9373464 2.51059434 -1.966605 0.0492288124 0.9999693 PDCD11 1.531569e+03 0.2332229 0.10217719 2.282533 0.0224578646 0.9999693 CALHM1 3.046655e+00 -5.2568136 2.32239772 -2.263529 0.0236031257 0.9999693 MTG1 1.026236e+03 0.2439932 0.11858684 2.057507 0.0396375250 0.9999693 NLRP6 3.214085e+01 -1.1621081 0.58528001 -1.985559 0.0470822869 0.9999693 RPLP2 1.524136e+04 0.1664302 0.08107414 2.052814 0.0400905872 0.9999693 IGF2 5.134175e+03 0.3277814 0.10782522 3.039933 0.0023663097 0.9999693 PLEKHA7 1.940561e+03 0.2364864 0.09969680 2.372056 0.0176894221 0.9999693 TIMM10 2.829806e+02 0.4811992 0.20926413 2.299482 0.0214775686 0.9999693 PATL1-DT 3.107467e+00 4.8580770 2.41130934 2.014705 0.0439355683 0.9999693 SLC22A9 2.501846e+02 -0.4531382 0.21356557 -2.121776 0.0338565810 0.9999693 DRAP1 1.538566e+03 0.2056946 0.10459119 1.966653 0.0492231960 0.9999693 SPTBN2 1.488121e+03 0.2476250 0.10656302 2.323742 0.0201393327 0.9999693 MRPL21 1.685041e+03 0.2199392 0.09965129 2.207088 0.0273078782 0.9999693 LOC107984421 4.412140e+01 -0.9984333 0.50525207 -1.976109 0.0481424030 0.9999693 LOC102724775 3.989700e+00 -4.1409704 2.08600905 -1.985116 0.0471315414 0.9999693 APOA4 3.617575e+04 -0.1444424 0.06717206 -2.150335 0.0315287582 0.9999693 APOA1-AS 7.777299e+00 3.7407562 1.51663798 2.466479 0.0136448605 0.9999693 LOC107984373 2.796443e+00 -5.1621494 2.45105776 -2.106090 0.0351964944 0.9999693 GLB1L2 5.802411e+02 0.3173172 0.15570493 2.037939 0.0415559850 0.9999693 LINC00942 3.811638e+00 5.1580121 2.17089072 2.375989 0.0175019928 0.9999693 LOC105369631 5.318386e+00 4.0608308 1.90441122 2.132329 0.0329798298 0.9999693 PTMS 1.343952e+04 0.1725389 0.08089406 2.132899 0.0329330202 0.9999693 GNB3 1.101116e+02 0.6418808 0.31835581 2.016237 0.0437751824 0.9999693 ETNK1-DT 2.982029e+00 4.8031892 2.31685836 2.073148 0.0381585497 0.9999693 BMAL2 4.173664e+02 0.3823710 0.18221934 2.098411 0.0358688600 0.9999693 COL2A1 6.532592e+03 0.2650244 0.08130432 3.259659 0.0011154610 0.9999693 TROAP 1.502126e+03 0.2107304 0.10474903 2.011765 0.0442447533 0.9999693 LINC02381 1.030905e+01 2.5727143 1.12889290 2.278971 0.0226687814 0.9999693 LGR5 2.374197e+02 0.7122345 0.26804808 2.657115 0.0078812608 0.9999693 MIR331 4.768153e+00 -5.8973471 2.08146243 -2.833271 0.0046074310 0.9999693 LOC414300 3.782298e+00 -5.5762296 2.16777843 -2.572325 0.0101018150 0.9999693 RFLNA 3.140798e+02 0.4230898 0.19983253 2.117222 0.0342410353 0.9999693 NCOR2 6.173187e+03 0.1894863 0.08182397 2.315780 0.0205702877 0.9999693 UBL3 3.743334e+03 -0.1713541 0.08310233 -2.061965 0.0392110839 0.9999693 LOC105370169 3.396834e+00 4.9914897 2.23527814 2.233051 0.0255455942 0.9999693 TBC1D4 1.468187e+03 0.2659853 0.10782092 2.466917 0.0136281977 0.9999693 LINC03061 5.455709e+02 -0.3704986 0.16738864 -2.213403 0.0268698428 0.9999693 [ reached &#39;max&#39; / getOption(&quot;max.print&quot;) -- omitted 108 rows ] 3.2 CON vs PAC baseMean log2FoldChange lfcSE stat pvalue padj EGR1 8464.486 -0.8606164 0.09750736 -8.826168 1.083230e-18 1.471947e-14 RPS29 8231.324 0.5198973 0.11684088 4.449618 8.602319e-06 4.675704e-02 FOS 1347.093 -1.1548303 0.16365466 -7.056507 1.707395e-12 1.546729e-08 C3 9264.219 -0.9566841 0.09589308 -9.976571 1.930218e-23 5.245752e-19 ND4L 15301.557 0.4741163 0.09007488 5.263580 1.412773e-07 9.598733e-04 3.2.1 Heatmap #Create study design matrix meta_CA &lt;- metadata %&gt;% filter(treatment %in% c(&quot;CON&quot;,&quot;PAC&quot;)) group_CA &lt;- meta_CA$treatment design_CA &lt;- model.matrix(~0+group_CA) count_CA &lt;- counts[,colnames(counts) %in% meta_CA$sample] signif_genes_CA &lt;- rownames(sigtab_diagdds_CA) countsdeseq_sign_CA &lt;- count_CA[signif_genes_CA, ] %&gt;% as.matrix() #pdf(&quot;CON_PAC.pdf&quot;,width=10, height=8) heatmap.2(log2(countsdeseq_sign_CA + 1),ColSideColors=c(rep(&quot;black&quot;,3),rep(&quot;red&quot;,3)), key=TRUE, margins = c(9, 9), trace=&quot;none&quot;, col=heat.colors(200), scale=&quot;row&quot;, cexRow=2, cexCol = 2) #dev.off() 3.2.2 Plot (PAC vs. CON) sigtab_diagdds_CA %&gt;% mutate(Color = ifelse(log2FoldChange &lt;0, &quot;Treatment&quot;,&quot;Control&quot;))%&gt;% rownames_to_column(., &quot;genes&quot;)%&gt;% # ggplot(aes(x=genes, y=log2FoldChange)) + ggplot(aes(x=forcats::fct_reorder(genes,log2FoldChange), y=log2FoldChange, fill=Color)) + geom_col() + scale_fill_manual(breaks=c(&quot;Control&quot;,&quot;Treatment&quot;),labels=c(&quot;Control&quot;,&quot;Cell structures&quot;), values=c(&quot;#e5bd5b&quot;, &quot;#6b7398&quot;)) + geom_hline(yintercept=0) + coord_flip()+ theme(axis.text = element_text(size = 8), axis.title = element_text(size = 12), legend.position = &quot;right&quot;, legend.title = element_blank(), panel.background = element_blank(), panel.grid.major = element_line(size = 0.15, linetype = &#39;solid&#39;, colour = &quot;grey&quot;))+ xlab(&quot;Genes&quot;) + ylab(&quot;log2FoldChange&quot;) 3.3 CON vs PAM baseMean log2FoldChange lfcSE stat pvalue padj GPR157 4672.6940 -0.3620991 0.07408228 -4.887796 1.019712e-06 9.834272e-04 S100A6 480.5775 -0.8426622 0.17465147 -4.824822 1.401286e-06 1.247468e-03 SI 5055.8193 0.4378195 0.08239716 5.313527 1.075237e-07 1.382635e-04 RPL34 11147.1799 0.2856220 0.06369364 4.484309 7.315073e-06 4.703185e-03 EGR1 10063.5755 -1.0504416 0.07033182 -14.935511 1.935849e-50 2.240359e-46 DUSP1 2366.5649 -0.5934542 0.09815207 -6.046273 1.482350e-09 3.431048e-06 CITED2 2168.3375 -0.3591732 0.08920532 -4.026366 5.664554e-05 2.427995e-02 LOC124901232 247.7295 1.0662318 0.24862952 4.288436 1.799357e-05 9.916170e-03 CLIP2 1779.3600 -0.4108431 0.09610222 -4.275063 1.910831e-05 1.005184e-02 MUC3A 10028.2097 -0.2976112 0.07045065 -4.224393 2.395857e-05 1.155302e-02 MUC17 5325.5865 -0.2649258 0.06768147 -3.914304 9.066551e-05 3.618179e-02 LINC01004 286.0718 1.0383066 0.23100168 4.494801 6.963499e-06 4.703185e-03 NDRG1 17757.2218 -0.2839662 0.05275206 -5.383035 7.324012e-08 1.059510e-04 NEAT1 2526.9445 -0.4549812 0.10262565 -4.433407 9.275573e-06 5.649801e-03 EGLN3 691.2093 -0.6556989 0.15164397 -4.323936 1.532696e-05 8.868943e-03 FOS 1679.4899 -1.3603464 0.11905504 -11.426198 3.093609e-30 1.790117e-26 RPL26 12653.2163 0.2494786 0.06284529 3.969727 7.195510e-05 2.974058e-02 LUC7L3 10615.7149 0.2949070 0.07131380 4.135342 3.544257e-05 1.577603e-02 UBALD2 1989.5265 -0.4295243 0.10079652 -4.261301 2.032402e-05 1.022652e-02 FSTL3 6843.3367 -0.3239735 0.06359190 -5.094572 3.495295e-07 4.045105e-04 JUNB 1989.9013 -0.5427897 0.09849323 -5.510934 3.569339e-08 5.901138e-05 IER2 4311.5139 -0.5133494 0.07289364 -7.042444 1.888963e-12 5.465243e-09 CEACAM6 4847.2698 -0.3236241 0.07047089 -4.592309 4.383692e-06 3.170779e-03 UPB1 5806.3304 0.2799830 0.06715736 4.169059 3.058598e-05 1.415886e-02 BAIAP2L2 4683.9969 0.3144471 0.08086176 3.888700 1.007828e-04 3.887864e-02 RBM3 4879.1023 0.3978950 0.07933037 5.015671 5.284862e-07 5.560156e-04 ATP8 1288.8804 -0.9412088 0.11550335 -8.148757 3.676835e-16 1.418400e-12 ND5 72216.8042 -0.2249422 0.04777151 -4.708710 2.492893e-06 1.923350e-03 ND6 13819.8069 -0.3035512 0.05408515 -5.612468 1.994606e-08 3.847262e-05 CYTB 55413.9309 -0.2513509 0.05295326 -4.746656 2.068070e-06 1.709555e-03 3.3.1 Heatmap #Create study design matrix meta_CPAM &lt;- metadata %&gt;% filter(treatment %in% c(&quot;CON&quot;,&quot;PAM&quot;)) group_CPAM &lt;- meta_CPAM$treatment design_CPAM &lt;- model.matrix(~0+group_CPAM) count_CPAM &lt;- counts[,colnames(counts) %in% meta_CPAM$sample] signif_genes_CPAM &lt;- rownames(sigtab_diagdds_CPAM) countsdeseq_sign_CPAM &lt;- count_CPAM[signif_genes_CPAM, ] %&gt;% as.matrix() #pdf(&quot;CON_PAM.pdf&quot;,width=10, height=8) heatmap.2(log2(countsdeseq_sign_CPAM + 1),ColSideColors=c(rep(&quot;black&quot;,3),rep(&quot;red&quot;,3)), key=TRUE, margins = c(7, 7), trace=&quot;none&quot;, col=heat.colors(200), scale=&quot;row&quot;, cexRow=1.5, cexCol = 1.5) #dev.off() 3.3.2 Plot (PAM vs. CON) sigtab_diagdds_CPAM %&gt;% mutate(Color = ifelse(log2FoldChange &lt;0, &quot;Treatment&quot;,&quot;Control&quot;))%&gt;% rownames_to_column(., &quot;genes&quot;)%&gt;% # ggplot(aes(x=genes, y=log2FoldChange)) + ggplot(aes(x=forcats::fct_reorder(genes,log2FoldChange), y=log2FoldChange, fill=Color)) + geom_col() + scale_fill_manual(breaks=c(&quot;Control&quot;,&quot;Treatment&quot;),labels=c(&quot;Control&quot;,&quot;Metabolites&quot;), values=c(&quot;#e5bd5b&quot;, &quot;#6b7398&quot;)) + geom_hline(yintercept=0) + coord_flip()+ theme(axis.text = element_text(size = 8), axis.title = element_text(size = 12), legend.position = &quot;right&quot;, legend.title = element_blank(), panel.background = element_blank(), panel.grid.major = element_line(size = 0.15, linetype = &#39;solid&#39;, colour = &quot;grey&quot;))+ xlab(&quot;Genes&quot;) + ylab(&quot;log2FoldChange&quot;) 3.4 PAM vs PAC baseMean log2FoldChange lfcSE stat pvalue padj CCL20 282.6424 1.4674471 0.2952392 4.970368 6.682605e-07 0.01251584 C3 9650.3770 0.9346333 0.1904111 4.908501 9.177515e-07 0.01251584 "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
